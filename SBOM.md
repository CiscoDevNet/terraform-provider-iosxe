# Software Bill of Materials (SBOM)

## What is an SBOM?

A Software Bill of Materials (SBOM) is a comprehensive inventory of all components, libraries, and dependencies included in this software. SBOMs provide transparency into the software supply chain, enabling security teams to identify vulnerabilities, track licenses, and ensure compliance with organizational policies.

## Available Formats

This provider includes SBOMs in two industry-standard formats:

- **SPDX JSON** (ISO/IEC 5962:2021): The international standard for software package data exchange, widely used for regulatory compliance and legal obligations. Best for license compliance and government requirements.

- **CycloneDX JSON** (OWASP): An OWASP specification optimized for security use cases and vulnerability management. Best for security scanning and DevSecOps workflows.

## Where to Find SBOMs

### Latest Version (Repository)
The most recent SBOM is available in the repository at:
- `sbom/latest/sbom.spdx.json`
- `sbom/latest/sbom.cyclonedx.json`

**Note**: These files are automatically updated after each release by the GitHub Actions workflow. They typically appear within a few minutes of release publication.

### Historical Versions
All release-specific SBOMs are attached to [GitHub Releases](https://github.com/CiscoDevNet/terraform-provider-iosxe/releases) as:
- `terraform-provider-iosxe_vX.Y.Z_sbom.spdx.json`
- `terraform-provider-iosxe_vX.Y.Z_sbom.cyclonedx.json`

**Download Example:**
```bash
# Replace VERSION with the desired release version
VERSION=v0.13.0
curl -LO https://github.com/CiscoDevNet/terraform-provider-iosxe/releases/download/${VERSION}/terraform-provider-iosxe_${VERSION}_sbom.spdx.json
curl -LO https://github.com/CiscoDevNet/terraform-provider-iosxe/releases/download/${VERSION}/terraform-provider-iosxe_${VERSION}_sbom.cyclonedx.json
```

## Using SBOM Files

### Vulnerability Scanning

**With Grype (SPDX or CycloneDX):**
```bash
# Install Grype
curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh

# Scan SBOM for vulnerabilities
grype sbom:./sbom/latest/sbom.spdx.json
```

**With Trivy (CycloneDX):**
```bash
# Install Trivy
brew install trivy

# Scan SBOM
trivy sbom ./sbom/latest/sbom.cyclonedx.json
```

**With Snyk (CycloneDX):**
```bash
# Requires Snyk account and CLI
snyk test --file=sbom/latest/sbom.cyclonedx.json --package-manager=gomodules
```

### License Compliance

**With SPDX Tools:**
```bash
# Validate SPDX format
pip install spdx-tools
pyspdxtools -i sbom/latest/sbom.spdx.json
```

**Extract License Information:**
```bash
# Using jq to extract licenses
jq '.packages[].licenseConcluded' sbom/latest/sbom.spdx.json | sort -u
```

### Dependency Analysis

**List All Dependencies:**
```bash
# SPDX format
jq '.packages[] | select(.name != "terraform-provider-iosxe") | {name, version}' sbom/latest/sbom.spdx.json

# CycloneDX format
jq '.components[] | {name, version}' sbom/latest/sbom.cyclonedx.json
```

**Track Dependency Changes:**
```bash
# Compare SBOMs across versions using git
git diff v0.13.0 v0.14.0 -- sbom/latest/sbom.spdx.json
```

## Generation Details

- **Tool**: [Syft](https://github.com/anchore/syft) by Anchore
- **Input**: Provider source code and Go module dependencies (`go.mod`)
- **Automation**: Fully automated during release via GitHub Actions
- **Frequency**: Every release (tagged with `v*` pattern)
- **Repository Update**: Automated commit to `sbom/latest/` within minutes of release

SBOMs are generated by scanning the provider's Go binary and analyzing the complete dependency tree, including direct and transitive dependencies. After the release is published, a separate workflow job automatically updates the `sbom/latest/` directory in the repository with the new SBOM files.

## Verification and Integrity

SBOMs are included in the provider's SHA256SUMS file, which is GPG-signed using the same key that signs the provider binaries. To verify integrity:

```bash
# Download release assets (replace VERSION with actual release)
VERSION=v0.13.0  # Use actual release version
curl -LO https://github.com/CiscoDevNet/terraform-provider-iosxe/releases/download/${VERSION}/terraform-provider-iosxe_${VERSION}_SHA256SUMS
curl -LO https://github.com/CiscoDevNet/terraform-provider-iosxe/releases/download/${VERSION}/terraform-provider-iosxe_${VERSION}_SHA256SUMS.sig
curl -LO https://github.com/CiscoDevNet/terraform-provider-iosxe/releases/download/${VERSION}/terraform-provider-iosxe_${VERSION}_sbom.spdx.json

# Verify checksum signature (import GPG key first - see SECURITY.md for key details)
gpg --verify terraform-provider-iosxe_${VERSION}_SHA256SUMS.sig terraform-provider-iosxe_${VERSION}_SHA256SUMS

# Verify SBOM checksum
grep sbom.spdx.json terraform-provider-iosxe_${VERSION}_SHA256SUMS | shasum -a 256 -c
```

## Compliance and Standards

This SBOM implementation follows:
- **NTIA Minimum Elements** for SBOM (U.S. Executive Order 14028)
- **SPDX 2.3** specification (ISO/IEC 5962:2021)
- **CycloneDX 1.5+** specification (OWASP)

## Questions or Issues?

If you have questions about SBOM usage or find issues with the generated SBOMs, please [open an issue](https://github.com/CiscoDevNet/terraform-provider-iosxe/issues) with the `sbom` label.

## Additional Resources

- [SPDX Specification](https://spdx.dev/specifications/)
- [CycloneDX Specification](https://cyclonedx.org/specification/overview/)
- [Syft Documentation](https://github.com/anchore/syft)
- [NTIA SBOM Guidelines](https://www.ntia.gov/page/software-bill-materials)
- [CISA SBOM Resources](https://www.cisa.gov/sbom)
