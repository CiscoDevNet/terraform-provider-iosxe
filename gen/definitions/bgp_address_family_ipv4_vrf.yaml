---
name: BGP Address Family IPv4 VRF
path: /Cisco-IOS-XE-native:native/router/Cisco-IOS-XE-bgp:bgp[id=%v]/address-family/with-vrf/ipv4[af-name=%s]
skip_minimum_test: true
doc_category: BGP
attributes:
  - yang_name: id
    tf_name: asn
    example: 65000
  - yang_name: af-name
    example: unicast
  - yang_name: vrf
    tf_name: vrfs
    type: List
    attributes:
      - yang_name: name
        example: VRF1
        id: true
      - yang_name: ipv4-unicast/advertise/l2vpn/evpn
        tf_name: ipv4_unicast_advertise_l2vpn_evpn
        example: true
      - yang_name: ipv4-unicast/redistribute-vrf/connected
        tf_name: ipv4_unicast_redistribute_connected
        example: true
      - yang_name: ipv4-unicast/bgp/router-id/id-choice/interface/interface/interface-choice/Loopback/Loopback
        xpath: ipv4-unicast/bgp/router-id/interface/Loopback
        tf_name: ipv4_unicast_router_id_loopback
        example: 101
      - yang_name: ipv4-unicast/bgp/router-id/id-choice/ip-id/ip-id
        xpath: ipv4-unicast/bgp/router-id/ip-id
        tf_name: ipv4_unicast_router_id_ip
        example: 10.1.1.1
      - yang_name: ipv4-unicast/aggregate-address
        tf_name: ipv4_unicast_aggregate_addresses
        type: List
        attributes:
          - yang_name: ipv4-address
            id: true
            example: 50.0.0.0
          - yang_name: ipv4-mask
            id: true
            example: 255.255.0.0
      - yang_name: ipv4-unicast/redistribute-vrf/static
        tf_name: ipv4_unicast_redistribute_static
        example: true
      - yang_name: ipv4-unicast/network/with-mask
        tf_name: ipv4_unicast_networks_mask
        type: List
        attributes:
          - yang_name: number
            tf_name: network
            id: true
            example: 12.0.0.0
          - yang_name: mask
            id: true
            example: 255.255.0.0
          - yang_name: route-map
            example: RM1
          - yang_name: network-option/backdoor/backdoor
            xpath: backdoor
            tf_name: backdoor
            example: true
          - yang_name: network-option/evpn/evpn
            xpath: evpn
            tf_name: evpn
            example: true
            exclude_test: true
      - yang_name: ipv4-unicast/network/no-mask
        tf_name: ipv4_unicast_networks
        type: List
        attributes:
          - yang_name: number
            tf_name: network
            id: true
            example: 13.0.0.0
          - yang_name: route-map
            example: RM1
          - yang_name: network-option/backdoor/backdoor
            xpath: backdoor
            tf_name: backdoor
            example: true
          - yang_name: network-option/evpn/evpn
            xpath: evpn
            tf_name: evpn
            example: true
            exclude_test: true
      - yang_name: ipv4-unicast/distance/adm-distance
        tf_name: ipv4_unicast_admin_distances
        type: List
        attributes:
          - yang_name: distance
            id: true
            example: 200
          - yang_name: srcip
            tf_name: source_ip
            id: true
            example: 10.1.1.1
          - yang_name: wildbits
            tf_name: wildcard
            id: true
            example: 0.0.0.0
          - yang_name: acl
            example: 100
            exclude_test: true
      - yang_name: ipv4-unicast/distance/bgp/extern-as
        tf_name: ipv4_unicast_distance_bgp_external
        example: 20
      - yang_name: ipv4-unicast/distance/bgp/internal-as
        tf_name: ipv4_unicast_distance_bgp_internal
        example: 200
      - yang_name: ipv4-unicast/distance/bgp/local
        example: 200

test_prerequisites:
  - path: /Cisco-IOS-XE-native:native/vrf/definition[name=VRF1]
    no_delete: true
    attributes:
      - name: name
        value: VRF1
      - name: rd
        value: 1:1
      - name: address-family/ipv4
        value: ""
  - path: /Cisco-IOS-XE-native:native/router/Cisco-IOS-XE-bgp:bgp[id=65000]
    attributes:
      - name: id
        value: 65000
    dependencies: [0]
  - path: /Cisco-IOS-XE-native:native/interface/Loopback[name=101]
    attributes:
      - name: name
        value: 101
      - name: ip/address/primary/address
        value: 22.22.22.22
      - name: ip/address/primary/mask
        value: 255.255.255.255
      - name: vrf/forwarding
        value: VRF1
    dependencies: [0]
